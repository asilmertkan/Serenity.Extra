import{a as u,b as se,c as S,d as E,f as k,g as D}from"./chunk-FEDAVPE7.js";var ee=se((Ae,Z)=>{Z.exports=Serenity.Extensions});var h=S(D(),1),l=S(k(),1);var p=S(D(),1),b=S(k(),1);var Q=S(D(),1),O=S(k(),1);var ne=S(D(),1),H=S(k(),1);var A=S(k(),1);var oe=S(D(),1);var z=S(D(),1);function L(m,x){let e=m.find(".bangla-only, .s-QuickSearchInput, .s-StringEditor, .s-TextAreaEditor, .select2-input").filter(function(){return $(this).closest(".english-only,.do-not-change-ANSI-font").length==0});x=="phonetic"?e.bnKb({switchkey:{webkit:"7",mozilla:"7",msie:"7"},driver:window.phonetic}):x=="probhat"?e.bnKb({switchkey:{webkit:"8",mozilla:"8",msie:"8"},driver:window.probhat}):x=="unijoy"?e.bnKb({switchkey:{webkit:"9",mozilla:"9",msie:"9"},driver:window.unijoy}):x=="english"?e.bnKb.toggle():e.bnKb({switchkey:{webkit:"7",mozilla:"7",msie:"7"},driver:window.phonetic})}u(L,"switchKeybordLayout");var K=null,j=!0,M={AutoColumnSize:!0,FadeInEffectWhenInit:!0,ShowAnyInEqualityFilterWithTextValue:!0,ShowInlineActionsColumn:!0,ShowDeleteInlineButtun:!1,ShowEditInlineButtun:!0,ShowPrintInlineButtun:!1,ShowRowNumberColumn:!0,ShowRowSelectionCheckboxColumn:!1,EnableQuickSearch:!0,RowsPerPage:20};var U={AutoFitContentArea:!0,HideCategoyLinksBar:!0,PendingChangesConfirmation:!0,ShowSaveAndNewButtonInToolbar:!1,ShowCloseButtonInToolbar:!1,ShowRefreshButtonInToolbar:!1,ShowChangeLogButtonInToolbar:!0,ShowReplaceRowButtonInToolbar:!1,ShowKeyboardLayoutButtonInToolbar:!1};function d(m,x){var e=H.text(m);return e==m?x:e}u(d,"text");var R=class extends Q.TemplatedDialog{constructor(e){super(e);this.onSuccess=u(e=>{},"onSuccess");var i=e.gridType;i.prototype||(i=O.getType(e.gridType));try{this.checkGrid=new i(this.byId("RowSelectionCheckGrid"),e),e.preSelectedKeys&&(this.checkGrid.selectedKeys=e.preSelectedKeys),this.dialogTitle=d("Controls.Select","Select")+" - "+this.checkGrid.getTitle(),this.checkGrid.setTitle(null),this.checkGrid.element.height(500),this.checkGrid.pickerDialog=this}catch(r){console.warn("Could not intialize "+e.gridType)}}getTemplate(){return`<div id="~_RowSelectionCheckGrid" 
                class="RowSelectionCheckGrid ${this.options.multiple==!0?"multi-select":"single-select"}" 
                style = "margin: 15px 15px 0 15px;" >
            </div>`}get selectedItems(){return this.checkGrid.selectedItems}getDialogOptions(){let e=super.getDialogOptions();return e.buttons=[{text:O.text("Dialogs.OkButton"),click:()=>{var i=this.checkGrid.selectedItems;if(!i.length){O.notifyWarning("Please select some items!");return}this.onSuccess(i),this.dialogClose()}},{text:O.text("Dialogs.CancelButton"),click:()=>{this.dialogClose()}}],e.height=500,e}};u(R,"GridItemPickerDialog"),R=E([Q.Decorators.registerClass()],R);var T=class extends p.Widget{constructor(e,i){super(e,i);this.options=i;this.selectedItemIncludeColumns=[];this.element.addClass("select2-offscreen"),this.containerDiv=$(`<div class="editor s-GridItemPickerEditor select2-container ${i.multiple?"select2-container-multi":""} has-inplace-button">
                        <div class="${i.multiple?"select2-choices":"select2-choice"}">
                            <div class="display-text" style="user-select: text; padding-right: 20px;${i.multiple?"padding-left: 5px;":""}"></div>
                            <a class="select2-search-choice-close btn-clear-selection" style="margin-top: 2px; cursor: pointer; left: unset;"></a>
                        </div>
                    </div>`).insertBefore(this.element),this.addInplaceButtons(),this.setCascadeFrom(this.options.cascadeFrom)}addInplaceButtons(){var e=this;this.inplaceSearchButton=$('<a style="padding-top: 2px;"><i class="fa fa-search"></i></a>').addClass("inplace-button inplace-search align-center").attr("title","search").insertAfter(this.containerDiv).click(function(i){e.inplaceSearchClick(i)}),this.inplaceViewButton=$('<a style="padding-top: 2px;"><i class="fa fa-eye"></i></a>').addClass("inplace-button inplace-view align-center").attr("title","view").click(function(i){e.inplaceViewClick(i)}).hide(),this.options.inplaceView!=!1&&!this.options.multiple&&this.inplaceViewButton.insertAfter(this.containerDiv),this.clearSelectionButton=this.containerDiv.find(".select2-search-choice-close").click(i=>{this.value="",this.text="",this._selectedItem=null,this.selectedItems=[],$(i.target).hide(),this.element.trigger("change")}).hide()}inplaceSearchClick(e){this.options.preSelectedKeys=this.values;var i=new R(this.options);i.onSuccess=r=>{this.value=i.checkGrid.rowSelection.getSelectedKeys().join(","),this.text=r.map(n=>n[this.options.nameFieldInGridRow]).join(", "),b.isEmptyOrNull(this.text)&&console.warn("nameFieldInGridRow might be wrong in "+this.widgetName),this._selectedItem=r[0],this.selectedItems=r,this.element.trigger("change")},i.dialogOpen()}inplaceViewClick(e){var i=this.value;if(!b.isEmptyOrNull(i)){var r=this.getDialogInstance();r.isReadOnly=!0,r.loadByIdAndOpenDialog(i,!1)}}getDialogInstance(){var e=this.options.dialogType;e.prototype||(e=b.getType(this.options.dialogType));try{var i=new e;return i}catch(r){console.warn("Could not intialize "+this.options.dialogType)}}get value(){return this.element.val()}set value(e){this.element.val(e),b.isEmptyOrNull(e)?(this.text="",this.inplaceViewButton.hide(),this.clearSelectionButton.hide()):(this.inplaceViewButton.show(),this.get_readOnly()==!1&&this.clearSelectionButton.show())}get values(){let e=this.value;return b.isEmptyOrNull(e)?[]:e.split(",")}set values(e){this.value=e.join(",")}get text(){return this.containerDiv.find(".display-text").text()}set text(e){this.containerDiv.find(".display-text").text(e)}getEditValue(e,i){this.options.multiple==!0?i[e.name]=this.values:i[e.name]=this.value}setEditValue(e,i){this.value=e[i.name];let r=e[this.options.nameFieldInThisRow];this.text=r,e[i.name]&&(this._selectedItem={},this._selectedItem[this.options.idFieldInGridRow]=e[i.name],this._selectedItem[this.options.nameFieldInGridRow]=r)}get_value(){return this.value}set_value(e){this.value=e}get_readOnly(){return this.element.hasClass("readonly")}set_readOnly(e){e?(this.element.addClass("readonly"),this.containerDiv.addClass("select2-container-disabled"),this.inplaceSearchButton.addClass("disabled").hide(),this.clearSelectionButton.addClass("disabled").hide()):(this.element.removeClass("readonly"),this.containerDiv.removeClass("select2-container-disabled"),this.inplaceSearchButton.removeClass("disabled").show(),this.clearSelectionButton.removeClass("disabled").show())}get_required(){return this.element.hasClass("required")}set_required(e){e?(this.element.addClass("required"),this.containerDiv.addClass("required"),this.containerDiv.find(".select2-choice, display-text").addClass("required")):(this.element.removeClass("required"),this.containerDiv.removeClass("required"),this.containerDiv.find(".select2-choice, display-text").removeClass("required"))}get selectedItem(){if(this._selectedItem&&this._selectedItem[this.options.nameFieldInGridRow]&&this.selectedItemIncludeColumns.every(e=>this._selectedItem[e]))return this._selectedItem;if(!b.isEmptyOrNull(this.value))return b.serviceCall({service:this.serviceUrl+"/Retrieve",request:{EntityId:this.value,ColumnSelection:p.RetrieveColumnSelection.list,IncludeColumns:this.selectedItemIncludeColumns},async:!1,onSuccess:e=>{this._selectedItem=e.Entity}}),this._selectedItem}get serviceUrl(){if(b.isEmptyOrNull(this._serviceUrl)){var e=this.getDialogInstance();this._serviceUrl=e.getService()}return this._serviceUrl}setValueAndText(e,i){this.value=e,this.text=i}getCascadeFromValue(e){return p.EditorUtils.getValue(e)}setCascadeFrom(e){if(b.isEmptyOrNull(e)){this.cascadeLink!=null&&(this.cascadeLink.set_parentID(null),this.cascadeLink=null),this.options.cascadeFrom=null;return}this.cascadeLink=new p.CascadedWidgetLink(p.Widget,this,i=>{this.set_cascadeValue(this.getCascadeFromValue(i))}),this.cascadeLink.set_parentID(e),this.options.cascadeFrom=e}get_cascadeFrom(){return this.options.cascadeFrom}get cascadeFrom(){return this.get_cascadeFrom()}set_cascadeFrom(e){e!==this.options.cascadeFrom&&(this.setCascadeFrom(e),this.updateItems())}set cascadeFrom(e){this.set_cascadeFrom(e)}get_cascadeField(){return b.coalesce(this.options.cascadeField,this.options.cascadeFrom)}get cascadeField(){return this.get_cascadeField()}set_cascadeField(e){this.options.cascadeField=e}set cascadeField(e){this.set_cascadeField(e)}get_cascadeValue(){return this.options.cascadeValue}get cascadeValue(){return this.get_cascadeValue()}set_cascadeValue(e){this.options.cascadeValue!==e&&(this.options.cascadeValue=e,this.set_value(null),this.updateItems())}set cascadeValue(e){this.set_cascadeValue(e)}get_filterField(){return this.options.filterField}get filterField(){return this.get_filterField()}set_filterField(e){this.options.filterField=e}set filterField(e){this.set_filterField(e)}get_filterValue(){return this.options.filterValue}get filterValue(){return this.get_filterValue()}set_filterValue(e){this.options.filterValue!==e&&(this.options.filterValue=e,this.set_value(null),this.updateItems())}set filterValue(e){this.set_filterValue(e)}updateItems(){}};u(T,"GridItemPickerEditor"),T=E([p.Decorators.registerEditor("_Ext.GridItemPickerEditor",[p.ISetEditValue,p.IGetEditValue,p.IStringValue,p.IReadOnly,p.IValidateRequired]),p.Decorators.element('<input type="text" />')],T);var W=S(k(),1);function J(m){$.ajax({url:m,dataType:"script",async:!1,cache:!0,success:function(){},error:function(){throw new Error("Could not load script "+m)}})}u(J,"loadScript");function Y(){window.Slick&&window.Slick.Editors&&window.Slick.Editors.Text||J(W.resolveUrl("~/lib/_Ext/Editors/slick.editors.js"))}u(Y,"usingSlickGridEditors");function X(){window.Slick&&window.Slick.AutoColumnSize||J(W.resolveUrl("~/lib/_Ext/CustomSlickGridPlugin/slick.autocolumnsize.js"))}u(X,"usingSlickAutoColumnSize");var B=S(ee(),1);var P=class extends h.EntityGrid{constructor(e,i){super(e,i);this.isAutosized=!1;this.isChildGrid=!1;this.nextRowNumber=1;let r=this.get_ExtGridOptions();r.AutoColumnSize==!0&&this.slickContainer.fadeTo(0,0),r.ShowRowSelectionCheckboxColumn==!0&&(this.rowSelection=new h.GridRowSelectionMixin(this));let n=this.getGrouping();n.length>0&&this.setGrouping(n)}get_ExtGridOptions(){return l.deepClone(M)}isPickerMode(){return this.element.hasClass("RowSelectionCheckGrid")}getGrouping(){return[]}markupReady(){super.markupReady(),setTimeout(()=>{this.isAutosized==!1&&(this.get_ExtGridOptions().AutoColumnSize==!0&&this.resizeAllCulumn(),this.slickContainer.fadeTo(100,1))},100)}getButtons(){var e=super.getButtons();let i=this.getReportRequest();return i.ListExcelServiceMethodName&&e.push(B.ExcelExportHelper.createToolButton({grid:this,service:this.getService()+"/"+i.ListExcelServiceMethodName,onViewSubmit:()=>this.onViewSubmit(),separator:!0})),i.ReportKey?(e.push({title:d("Controls.ExportToPDF","Export to PDF"),icon:"fa fa-file-pdf-o",onClick:()=>{let r=this.getReportRequest();r&&B.ReportHelper.execute({reportKey:i.ReportKey,params:{request:r}})}}),e.push({title:d("Controls.ViewAsReport","View as Report"),icon:"fa fa-html5",onClick:()=>{let r=this.getReportRequest();r&&B.ReportHelper.execute({reportKey:i.ReportKey,params:{request:r},extension:"html"})}})):i.ReportServiceMethodName&&e.push({title:d("Controls.ViewAsReport","View as Report"),icon:"fa fa-eye",onClick:()=>{let r=this.getReportRequest();r&&l.postToService({service:l.resolveUrl(this.getService()+"/"+i.ReportServiceMethodName),request:r,target:"_blank"})}}),e}getReportRequest(){let e=this.getView();var i=l.deepClone(e?e.params:{});if(i.ReportServiceMethodName=null,i.ReportKey=null,i.ListExcelServiceMethodName=K,i.EqualityFilterWithTextValue={},i.CustomParameters={},e){let n=this.getQuickFilters();for(let t of n){let o=i.EqualityFilter[t.field];if(o&&o.length>0)if(t.options.lookupKey){let c=l.getLookup(t.options.lookupKey);i.EqualityFilterWithTextValue[t.title]=c.itemById[o][c.textField]}else if(t.options.enumKey){let c=t.options.enumKey,f=l.toId(o);i.EqualityFilterWithTextValue[t.title]=h.EnumFormatter.format(h.EnumTypeRegistry.get(c),f)}else if(t.type==T){var r=this.findQuickFilter(T,t.field);i.EqualityFilterWithTextValue[t.title]=r.text}else i.EqualityFilterWithTextValue[t.title]=o;else if(t.type==h.DateEditor){let c=this.findQuickFilter(h.DateEditor,t.field),f=c.element.val(),s=c.element.siblings("input").val(),a="";l.isEmptyOrNull(f)||(a=l.format(d("Controls.FromDate","From {0}"),f)+" "),l.isEmptyOrNull(s)||(a=a+l.format(d("Controls.ToDate","To {0}"),s)),l.isEmptyOrNull(a)?this.get_ExtGridOptions().ShowAnyInEqualityFilterWithTextValue==!0&&(i.EqualityFilterWithTextValue[t.title]=d("Controls.All","all")):i.EqualityFilterWithTextValue[t.title]=a}else this.get_ExtGridOptions().ShowAnyInEqualityFilterWithTextValue==!0&&(i.EqualityFilterWithTextValue[t.title]=d("Controls.All","all"))}if(this.filterBar){let t=this.filterBar.get_store().get_displayText();l.isEmptyOrNull(t)||(i.EqualityFilterWithTextValue[l.text("Controls.FilterPanel.EditFilter")]=t)}}return i}getColumns(){let e=super.getColumns(),i=this.getSlickOptions().editable,r=this.get_ExtGridOptions();if(i==!0&&Y(),e.forEach(t=>{let o=t.cssClass||"",c=t.minWidth||t.width||50;if(t.sourceItem){let f=t.sourceItem.formatterType;t.sourceItem.filteringType=="Lookup"?(o=" align-left",c=t.minWidth>100?t.minWidth:100):f=="Enum"?c=t.minWidth>100?t.minWidth:100:f=="Date"?(o=" align-center",c=t.minWidth>99?t.minWidth:99):f=="DateTime"?(o=" align-center",c=t.minWidth>140?t.minWidth:140):f=="Number"?o=" align-right":f=="Checkbox"?o=" align-center":(o=" align-left",c=t.minWidth>99?t.minWidth:99);let s=t.sourceItem.placeholder=="Controls.All"?d("Controls.All","All"):"-";if(t.sourceItem.editorType=="Lookup")t.sourceItem.editorParams.autoComplete||(t.format=a=>{let g=l.getLookup(t.sourceItem.editorParams.lookupKey);if(a.column.sourceItem.editorParams.multiple==!0){if(a.value){let C=a.value.map(v=>g.itemById[v]).map(v=>v[g.textField]);return C.length>0?C.join(", "):s}}else{let y=g.itemById[a.value];return y?y[g.textField]:s}});else if(t.sourceItem.editorType=="ServiceLookup")t.sourceItem.editorParams.autoComplete||(t.textFieldInThisRow=t.sourceItem.editorParams.textFieldInThisRow||t.sourceItem.editorParams.textField,t.formatter=(a,g,y,C,v)=>v?v[C.textFieldInThisRow]:s);else if(t.sourceItem.filteringType=="Lookup")t.formatter=(a,g,y,C,v)=>l.isEmptyOrNull(y)?s:y;else if(f=="Enum")t.formatter=(a,g,y,C,v)=>{let N=C.sourceItem.editorParams.enumKey;if(C.sourceItem.editorParams.multiple==!0){let F="",V=y;return V&&V.length>0&&(F=V.map(re=>h.EnumFormatter.format(h.EnumTypeRegistry.get(N),l.toId(re))).join(", ")),F||s}else{let F=h.EnumFormatter.format(h.EnumTypeRegistry.get(N),l.toId(y));return F||s}};else if(t.sourceItem.editorType=="Decimal"){let a="#,##0.00";if(t.sourceItem.editorParams){let g=t.sourceItem.editorParams.decimals;if(g){a="#,##0.";for(let y=0;y<g;y++)a+="0"}else if(t.sourceItem.editorParams.minValue){let y=t.sourceItem.editorParams.minValue.split(".");y.length>1?a="#,##0."+y[1]:a="#,##0"}}t.format=g=>h.NumberFormatter.format(g.value,a)}if(i==!0&&t.sourceItem.readOnly!=!0)if(j)t.editor=SerenityInlineEditor;else{let a=t.sourceItem.editorType;a=="Lookup"||a=="Enum"?(t.editor=Slick.Editors.Select2,c=t.minWidth>160?t.minWidth:160):a=="Date"?t.editor=Slick.Editors.Date:a=="Boolean"?t.editor=Slick.Editors.Checkbox:a=="Integer"?t.editor=Slick.Editors.Integer:a=="Decimal"?t.editor=Slick.Editors.Float:a=="YesNoSelect"?t.editor=Slick.Editors.YesNoSelect:a=="PercentComplete"?t.editor=Slick.Editors.PercentComplete:a=="LongText"?t.editor=Slick.Editors.LongText:t.editor=Slick.Editors.Text}}t.cssClass+=o,this.get_ExtGridOptions().AutoColumnSize==!0&&(t.width=c)}),e.unshift({field:"RowNum",name:"#",cssClass:"rownum-column",headerCssClass:"align-center",width:40,minWidth:40,maxWidth:40,visible:r.ShowRowNumberColumn,format:t=>(t.item.RowNum||(t.item.RowNum=this.nextRowNumber++),String(t.item.RowNum))}),r.ShowInlineActionsColumn==!0){let t=0,o="";if(r.ShowEditInlineButtun==!0){t+=32;var n=this.isReadOnly?d("Controls.View","View Details"):d("Controls.Edit","Edit");o+=`<a class="inline-actions view-details" title="${n}" style="font-size: 1.2em;"><i class="view-details fa fa-pencil-square-o"></i></a>`}r.ShowDeleteInlineButtun==!0&&(t+=22,o+=`<a class="inline-actions delete-row" title="${d("Controls.Delete","Delete")}" style="padding-left: 5px;"><i class="delete-row fa fa-trash-o text-red"></i></a>`),r.ShowPrintInlineButtun==!0&&(t+=25,o+=`<a class="inline-actions print-row" title="${d("Controls.Print","Print")}" style="padding-left: 5px;"><i class="print-row fa fa-print"></i></a>`),e.unshift({field:"inline-actions",name:"",cssClass:"inline-actions-column",width:t,minWidth:t,maxWidth:t,formatter:(c,f,s,a,g)=>o})}if(r.ShowRowSelectionCheckboxColumn==!0){let t=h.GridRowSelectionMixin.createSelectColumn(()=>this.rowSelection);t.width=t.minWidth=t.maxWidth=27,e.unshift(t)}if(this.isPickerMode()){let t=this.options;if(!t.multiple&&!t.gridType&&l.notifyWarning("Could not determine multiple/single. Probably there is no 'options' parameter in grid's constructor."),e.forEach(o=>{o.sourceItem&&o.sourceItem.editLink&&(o.format=void 0)}),t.multiple==!0){let o=h.GridRowSelectionMixin.createSelectColumn(()=>this.rowSelection);o.width=o.minWidth=o.maxWidth=27,e.unshift(o)}else e.unshift({field:"row-selection",name:"",cssClass:"inline-actions-column",width:66,minWidth:66,maxWidth:66,format:o=>'<a class="inline-actions select-row"><i class="select-row fa fa-check"></i> Select</a>'})}return e}createSlickGrid(){var e=super.createSlickGrid();return X(),Slick.AutoColumnSize&&(this.autoColumnSizePlugin=new Slick.AutoColumnSize,e.registerPlugin(this.autoColumnSizePlugin)),e.registerPlugin(new Slick.Data.GroupItemMetadataProvider),e}resetColumns(e){this.slickContainer.fadeTo(0,0),this.slickGrid.setColumns(e),setTimeout(()=>{this.get_ExtGridOptions().AutoColumnSize==!0&&this.resizeAllCulumn(),this.slickContainer.fadeTo(100,1)},100)}resizeAllCulumn(){this.isAutosized=!0;let e=this.slickContainer.width();e>0||(e=this.element.closest(".s-Dialog").width()-55),e>0||(e=this.element.closest(".s-Panel").width()-55),e>0||(e=$("section.content").width()-75),this.slickGrid.setOptions({forceFitColumns:!1});let i=this.autoColumnSizePlugin.resizeAllColumns().filter(n=>n.visible!=!1),r=0;if(i.map(n=>n.width).forEach(n=>r+=n),r>e)this.autoColumnSizePlugin.resizeAllColumns();else if(r<e){this.autoColumnSizePlugin.resizeAllColumns();let n=[],t=[];i.forEach(s=>{s.minWidth==s.maxWidth?(n.push(s),s.width=s.maxWidth):s.cssClass&&s.cssClass.indexOf("no-auto-size")>=0?n.push(s):s.sourceItem?s.sourceItem.formatterType==String("Number")?n.push(s):s.sourceItem.filteringType==String("Enum")||s.sourceItem.formatterType==String("Date")?(n.push(s),s.width<80&&(s.width=80)):s.sourceItem.formatterType==String("DateTime")?(n.push(s),s.width<150&&(s.width=150)):s.sourceItem.formatterType==String("Checkbox")?n.push(s):t.push(s):t.push(s)}),t.length==0&&(n=[],t=[],i.forEach(s=>{s.minWidth==s.maxWidth?(n.push(s),s.width=s.maxWidth):t.push(s)}));let o=0;n.map(s=>s.width).forEach(s=>o+=s);let c=e-o-(this.isChildGrid?48:18),f=0;t.map(s=>s.width).forEach(s=>f+=s),t.forEach(s=>{let a=c/f,g=s.width*a,y=g-s.width;s.width=g}),this.slickGrid.setColumns(i),this.slickGrid.onColumnsResized.notify()}this.setItems(this.getItems())}getSlickOptions(){let e=super.getSlickOptions();return this.get_ExtGridOptions().AutoColumnSize==!0&&(e.forceFitColumns=!0),e.enableTextSelectionOnCells=!0,e.enableCellNavigation=!0,e.asyncEditorLoading=!1,e.autoEdit=!0,e.rowHeight=27,e}getViewOptions(){let e=super.getViewOptions();return e.rowsPerPage=M.RowsPerPage,e}getPrintRowServiceMethod(){return"Print"}onClick(e,i,r){if(super.onClick(e,i,r),e.isDefaultPrevented())return;var n=this.itemAt(i);let t=n[this.getIdProperty()];var o=$(e.target);(o.parent().hasClass("inline-action")||o.parent().hasClass("inline-actions")||o.parent().hasClass("inline-btn"))&&(o=o.parent()),(o.hasClass("inline-action")||o.hasClass("inline-actions")||o.hasClass("inline-btn"))&&this.onInlineActionClick(o,t,n)}onInlineActionClick(e,i,r){if(e.hasClass("delete-row"))this.isReadOnly==!0?l.notifyWarning("Read only records could not be deleted!"):l.confirm(d("Db.Administration.Translation.DeleteWarning","Delete record?"),()=>{let n=this;n.deleteEntity?n.deleteEntity(i):l.serviceRequest(this.getService()+"/Delete",{EntityId:i},t=>{this.refresh()})});else if(e.hasClass("view-details"))this.slickGrid.getEditController().commitCurrentEdit(),this.editItem(i);else if(e.hasClass("print-row")){let n={EntityId:i};l.postToService({service:l.resolveUrl(this.getService()+"/"+this.getPrintRowServiceMethod()),request:n,target:"_blank"})}else e.hasClass("select-row")&&(this.rowSelection.setSelectedKeys([i]),this.pickerDialog.onSuccess(this.selectedItems),this.pickerDialog.dialogClose())}resetRowNumber(){this.nextRowNumber=1;let e=this.getItems(),i=this.view.getGrouping();if(i.length==0)for(let r=0;r<e.length;r++)e[r].RowNum=r+1;else if(i.length>0){let r=u(t=>{for(let o=0;o<t.length;o++){let c=t[o].groups;if(c)r(c);else{let f=t[o].rows;for(let s=0;s<f.length;s++)f[s].RowNum=s+1}}},"generateRowNumber"),n=this.view.getGroups();r(n)}this.setItems(e)}setGrouping(e){this.view.setGrouping(e),this.resetRowNumber()}getIncludeColumns(e){super.getIncludeColumns(e);let i=this.getGrouping();i.length>0&&i.forEach(r=>e[r.getter]=!0)}getDefaultSortBy(){let e=super.getDefaultSortBy(),i=this.getGrouping();return i.length>0&&i.forEach(r=>e.unshift(r.getter)),e}onViewProcessData(e){let i=super.onViewProcessData(e);return this.get_ExtGridOptions().ShowRowNumberColumn==!0&&setTimeout(()=>{this.resetRowNumber()}),i}initDialog(e){super.initDialog(e),e.parentGrid=this}get selectedItems(){return this.rowSelection.getSelectedKeys().map(e=>{let i=this.view.getItemById(e);return i||(i={},i[this.getIdProperty()]=e),i})}set selectedKeys(e){this.options.multiple==!0&&this.rowSelection.setSelectedKeys(e)}onViewSubmit(){if(!super.onViewSubmit())return!1;var e=this.view.params;let i=this.options;i.filteringCriteria&&(e.Criteria=h.Criteria.and(e.Criteria,i.filteringCriteria)),i.filterField&&l.isValue(i.filterValue)&&(e.EqualityFilter=e.EqualityFilter||{},e.EqualityFilter[i.filterField]=i.filterValue);let r=i.cascadeField||i.cascadeFrom;return r&&l.isValue(i.cascadeValue)&&(e.EqualityFilter=e.EqualityFilter||{},e.EqualityFilter[r]=i.cascadeValue),!0}};u(P,"GridBase"),P=E([h.Decorators.filterable()],P);var w=S(D(),1),I=S(k(),1);var _=S(D(),1),te=S(k(),1);function ie(m,x){m.on("dialogbeforeclose panelbeforeclose",function(e){!_.WX.hasOriginalEvent(e)||!x()||(e.preventDefault(),te.confirm(d("Controls.EntityDialog.PendingChangesConfirmation","You have pending changes. Save them?"),()=>m.find("div.save-and-close-button").click(),{onNo:function(){m.hasClass("ui-dialog-content")?m.dialog("close"):m.hasClass("s-Panel")&&_.TemplatedDialog.closePanel(m)}}))})}u(ie,"pendingChangesConfirmation");var G=class extends w.EntityDialog{constructor(e){super(e);this.isReadOnly=!1;this.get_ExtDialogOptions().PendingChangesConfirmation==!0&&ie(this.element,()=>this.getSaveState()!=this.loadedState)}getRowType(){return{}}getIdProperty(){return this.getRowType().idProperty}getLocalTextPrefix(){return this.getRowType().localTextPrefix}getNameProperty(){return this.getRowType().nameProperty}getInsertPermission(){return this.getRowType().insertPermission}getUpdatePermission(){return this.getRowType().updatePermission}getDeletePermission(){return this.getRowType().deletePermission}get_ExtDialogOptions(){return I.deepClone(U)}updateInterface(){super.updateInterface(),this.setReadOnly(this.isReadOnly)}onDialogOpen(){if(super.onDialogOpen(),this.get_ExtDialogOptions().AutoFitContentArea==!0&&this.fullContentArea(),this.get_ExtDialogOptions().HideCategoyLinksBar==!0){this.element.find(".category-links").hide();let e=this.element.find(".first-category > .category-title");I.isEmptyOrNull(e.find(".category-anchor").text())&&e.hide()}if(this.get_ExtDialogOptions().ShowKeyboardLayoutButtonInToolbar==!0){let e=this.element;this.toolbar.element.append(`<div class="dropdown pull-right" style="padding: 5px 10px;">
                    <a href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="${d("Controls.KeyboardLayout.Title","Keyboard Layout")}">
                        <i class="fa fa-keyboard-o"></i> <span class="selected-layout"> </span> <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right choose-keyboard">
                        <li class="dropdown-header">${d("Controls.KeyboardLayout.Title","Keyboard Layout")}</li>
                        <li data-kb="phonetic"><a href="javascript:"> ${d("Controls.KeyboardLayout.BanglaPhonetic","Bangla-Phonetic")}</a></li>
                        <li data-kb="probhat"><a href="javascript:"> ${d("Controls.KeyboardLayout.BanglaProbhat","Bangla-Probhat")}</a></li>
                        <li data-kb="unijoy"><a href="javascript:"> ${d("Controls.KeyboardLayout.BanglaUnijoy","Bangla-Unijoy")}</a></li>
                        <li data-kb="english"><a href="javascript:"> ${d("Controls.KeyboardLayout.English","English")}</a></li>
                    </ul>
                </div>`);let i=this.toolbar.element.find(".selected-layout"),r=this.toolbar.element.find(".choose-keyboard"),n=r.find("li");n.on("click",function(){let t=$(this),o=t.data("kb");o&&(i.text(t.text()),L(e,o),n.removeClass("active"),r.find('[data-kb="'+o+'"]').addClass("active"))})}setTimeout(()=>{this.onAfterSetDialogSize()},200)}onDialogClose(){super.onDialogClose(),this.onAfterDialogClose(this.getSaveEntity())}setReadOnly(e){if(this.readOnly=e,this.isReadOnly=e,this.isReadOnly==!0){this.saveAndCloseButton.toggleClass("disabled",this.isReadOnly),this.applyChangesButton.toggleClass("disabled",this.isReadOnly),this.deleteButton.toggleClass("disabled",this.isReadOnly),this.cloneButton.toggleClass("disabled",this.isReadOnly),this.undeleteButton.toggleClass("disabled",this.isReadOnly),this.toolbar.findButton("btn-save-and-close").addClass("disabled"),this.toolbar.findButton("btn-save-and-new").addClass("disabled"),this.toolbar.findButton("btn-replace-row").addClass("disabled"),this.toolbar.findButton("btn-history").addClass("disabled"),this.toolbar.findButton("btn-custom").addClass("disabled"),this.element.find("sup").toggle(this.isReadOnly);for(let i in this.form)if(this.form[i].widgetName)try{w.EditorUtils.setReadOnly(this.form[i],this.isReadOnly)}catch(r){}}}getToolbarButtons(){let e=super.getToolbarButtons(),i=this.get_ExtDialogOptions();i.ShowSaveAndNewButtonInToolbar==!0&&e.push({title:d("Controls.EntityDialog.SaveAndNew","Save & New"),icon:"fa fa-save",cssClass:"btn-save-and-new",onClick:()=>{this.onSaveAndNewButtonClick()}}),i.ShowCloseButtonInToolbar==!0&&e.push({title:d("Controls.EntityDialog.Close","Close"),icon:"fa fa-close",cssClass:"btn-close",onClick:()=>{this.dialogClose()}}),i.ShowRefreshButtonInToolbar==!0&&e.push({title:d("Controls.EntityDialog.Refresh","Refresh"),icon:"fa fa-refresh",onClick:()=>{this.onRefreshClick()}});try{let r=I.tryFirst(e,n=>n.cssClass=="clone-button");r.onClick=()=>{if(this.isEditMode()){var n=this.getCloningEntity();w.Widget.create({type:I.getInstanceType(this),init:t=>{this.parentGrid.initDialog(t),t.loadEntityAndOpenDialog(n,null)}}),this.dialogClose()}}}catch(r){}return e}onRefreshClick(){this.reloadById()}onSaveAndNewButtonClick(){this.save(e=>{this.loadEntity({})})}getSaveState(){try{return $.toJSON(this.getSaveEntity())}catch(e){return null}}onSaveSuccess(e){super.onSaveSuccess(e)}loadResponse(e){super.loadResponse(e),this.get_ExtDialogOptions().PendingChangesConfirmation==!0&&(this.loadedState=this.getSaveState())}maximize(){this.element.closest(".ui-dialog").find(".ui-dialog-titlebar-maximize").click(),setTimeout(()=>{let e=this.element?this.element.closest(".ui-dialog"):$(".ui-dialog"),i=e.height(),r=e.find(".ui-dialog-title").height()||20,n=this.element.find(".categories"),t=n.position().top;n.height(i-r-t-20)},100)}fullContentArea(){this.setDialogSize()}setDialogSize(e,i,r,n,t){t||(t=$("section.content")),t.length==0&&(t=$(".content-wrapper"));let o=this.element?this.element.closest(".ui-dialog"):$(".ui-dialog");if(t.length>0&&o.length>0){let c=t.width()+30+(e||0),f=t.height()+(i||30);this.element.dialog("option","width",c),this.element.dialog("option","height",f);let s=o.find(".ui-dialog-title").height()||20,a=this.element.find(".categories"),g=a.position().top;a.height(f-s-g-20),o.css({left:t.position().left+(n||0),top:r||50})}setTimeout(()=>{this.onAfterSetDialogSize()},200)}onAfterSetDialogSize(){}onAfterDialogClose(e){}};u(G,"DialogBase"),G=E([w.Decorators.responsive(),w.Decorators.maximizable()],G);export{G as a,P as b};
//# sourceMappingURL=chunk-WU2266R4.js.map
